ocu_bb_latency 10msec
comm_sri_latency 2msec
internal_latency 1msec

n1 : node {
  PUBLISHES o1 {TOPIC t }
  PERIOD 500msec
  CXX {HEADER "f1.h" CLASS "N1"}
}

t : topic { FIELDS
  x1 : float32 42
  timestamp = radl.start_time
}

r : node {
  SUBSCRIBES i1 { TOPIC t MAXLATENCY ocu_bb_latency }
  PUBLISHES o1 { TOPIC tt }
  PERIOD 500msec
  CXX { HEADER "gateway_1.h" CLASS "identity_1" }
}

tt = t

n2 : node {
  SUBSCRIBES i2 {TOPIC tt MAXLATENCY internal_latency }
  PERIOD 300msec
  CXX {HEADER "f2.h" CLASS "N2"}
}

n3 : node {
  SUBSCRIBES i2 {TOPIC tt MAXLATENCY comm_sri_latency }
  PERIOD 300msec
  CXX {HEADER "f2.h" CLASS "N2"}
}

test22 : plant {
  MACHINES
    ocu { OS { IP 192.168.15.112 NODES n1 NODES_UID 1000 IMG "linux.img" } }
    bb { OS h1 : certikos { VMS
     comm { OS { IP 192.168.15.121 NODES r NODES_UID 1000 IMG "linux.img" } }
     sri { OS { NODES n2 n3 NODES_UID 1000 IMG "linux.img" } }
}}}

settings : module_settings {
  MODULE_BASE_PATH "src"
}
